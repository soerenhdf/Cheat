-- Initiale Variablen
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local ball = workspace:WaitForChild("Ball")  -- Der Ball, mit dem der Spieler interagieren soll
local radius = 125  -- Radius des Kreises um den Ball
local speed = 0.05  -- Geschwindigkeit der Kreisbewegung
local movingInCircle = false  -- Wenn der Spieler sich im Kreis bewegt
local isFlying = false  -- Wenn der Spieler fliegt

-- Wallhack Variablen
local wallhackEnabled = false
local wallhackColor = Color3.fromRGB(255, 0, 0)  -- Rote Kisten für Gegner

-- TP Aura Variablen
local tpAuraEnabled = false
local tpDistance = 50  -- Maximaler Abstand zum Teleportieren
local tpSpeed = 0.2  -- Geschwindigkeit des Teleportierens

-- Erstelle das GUI Menü
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player:WaitForChild("PlayerGui")

local menuFrame = Instance.new("Frame")
menuFrame.Size = UDim2.new(0, 300, 0, 300)
menuFrame.Position = UDim2.new(0, 50, 0, 50)
menuFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
menuFrame.BackgroundTransparency = 0.5
menuFrame.Parent = screenGui

-- Erstelle Buttons
local flyButton = Instance.new("TextButton")
flyButton.Size = UDim2.new(0, 250, 0, 50)
flyButton.Position = UDim2.new(0, 25, 0, 25)
flyButton.Text = "Fly"
flyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
flyButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
flyButton.Parent = menuFrame

local bladeBallButton = Instance.new("TextButton")
bladeBallButton.Size = UDim2.new(0, 250, 0, 50)
bladeBallButton.Position = UDim2.new(0, 25, 0, 85)
bladeBallButton.Text = "Blade Ball"
bladeBallButton.TextColor3 = Color3.fromRGB(255, 255, 255)
bladeBallButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
bladeBallButton.Parent = menuFrame

local tpAuraButton = Instance.new("TextButton")
tpAuraButton.Size = UDim2.new(0, 250, 0, 50)
tpAuraButton.Position = UDim2.new(0, 25, 0, 145)
tpAuraButton.Text = "TP Aura"
tpAuraButton.TextColor3 = Color3.fromRGB(255, 255, 255)
tpAuraButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
tpAuraButton.Parent = menuFrame

local wallhackButton = Instance.new("TextButton")
wallhackButton.Size = UDim2.new(0, 250, 0, 50)
wallhackButton.Position = UDim2.new(0, 25, 0, 205)
wallhackButton.Text = "Wallhack"
wallhackButton.TextColor3 = Color3.fromRGB(255, 255, 255)
wallhackButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
wallhackButton.Parent = menuFrame

local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 100, 0, 50)
closeButton.Position = UDim2.new(0, 100, 0, 255)
closeButton.Text = "Close"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
closeButton.Parent = menuFrame

-- Menü Minimieren/Maximieren
local minimized = false
local minimizeButton = Instance.new("TextButton")
minimizeButton.Size = UDim2.new(0, 50, 0, 50)
minimizeButton.Position = UDim2.new(0, 250, 0, 0)
minimizeButton.Text = "-"
minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
minimizeButton.Parent = menuFrame

-- Funktion für das Fliegen
local function toggleFly()
    isFlying = not isFlying
    print("Fly toggled: " .. tostring(isFlying))  -- Debug-Ausgabe
    if isFlying then
        humanoidRootPart.Velocity = Vector3.new(0, 50, 0)  -- Spieler nach oben bewegen
    else
        humanoidRootPart.Velocity = Vector3.new(0, 0, 0)  -- Stoppe das Fliegen
    end
end

-- Funktion für Blade Ball
local function moveInCircle()
    while movingInCircle do
        wait(0.1)
        
        -- Berechne eine zufällige Position im Kreis um den Ball
        local ballPos = ball.Position
        local time = tick()
        local xOffset = math.cos(time * speed) * radius
        local zOffset = math.sin(time * speed) * radius
        
        local targetPosition = Vector3.new(ballPos.X + xOffset, ballPos.Y, ballPos.Z + zOffset)
        humanoidRootPart.CFrame = CFrame.new(targetPosition)
        humanoidRootPart.CFrame = CFrame.new(targetPosition, ball.Position)  -- Schaut immer zum Ball
    end
end

-- Funktion für Wallhack
local function toggleWallhack()
    wallhackEnabled = not wallhackEnabled
    print("Wallhack enabled: " .. tostring(wallhackEnabled))  -- Debug-Ausgabe
    if wallhackEnabled then
        -- Erstelle rote Kisten um alle Gegner
        for _, otherPlayer in pairs(game.Players:GetPlayers()) do
            if otherPlayer ~= player then
                local box = Instance.new("Part")
                box.Size = Vector3.new(4, 6, 4)
                box.Position = otherPlayer.Character.HumanoidRootPart.Position
                box.Anchored = true
                box.CanCollide = false
                box.Color = wallhackColor
                box.Parent = workspace
            end
        end
    else
        -- Entferne alle Wallhack-Objekte
        for _, obj in pairs(workspace:GetChildren()) do
            if obj:IsA("Part") and obj.Color == wallhackColor then
                obj:Destroy()
            end
        end
    end
end

-- Funktion für TP Aura
local function toggleTPAura()
    tpAuraEnabled = not tpAuraEnabled
    print("TP Aura enabled: " .. tostring(tpAuraEnabled))  -- Debug-Ausgabe
    while tpAuraEnabled do
        wait(0.1)
        
        -- Finde den nächsten Spieler
        local nearestPlayer = nil
        local minDistance = tpDistance
        
        for _, otherPlayer in pairs(game.Players:GetPlayers()) do
            if otherPlayer ~= player and otherPlayer.Character then
                local distance = (humanoidRootPart.Position - otherPlayer.Character.HumanoidRootPart.Position).magnitude
                if distance < minDistance then
                    nearestPlayer = otherPlayer
                    minDistance = distance
                end
            end
        end
        
        if nearestPlayer then
            -- Teleportiere dich näher zum nächsten Spieler
            local targetPosition = nearestPlayer.Character.HumanoidRootPart.Position + Vector3.new(math.random(-10, 10), 0, math.random(-10, 10))
            humanoidRootPart.CFrame = CFrame.new(targetPosition)
            humanoidRootPart.CFrame = CFrame.new(targetPosition, nearestPlayer.Character.HumanoidRootPart.Position)  -- Schaut immer zum nächsten Spieler
        end
    end
end

-- Funktion für Minimieren
minimizeButton.MouseButton1Click:Connect(function()
    if minimized then
        menuFrame.Size = UDim2.new(0, 300, 0, 300)
        minimized = false
        minimizeButton.Text = "-"
        -- Alle Buttons sichtbar machen
        flyButton.Visible = true
        bladeBallButton.Visible = true
        tpAuraButton.Visible = true
        wallhackButton.Visible = true
        closeButton.Visible = true
    else
        menuFrame.Size = UDim2.new(0, 50, 0, 50)
        minimized = true
        minimizeButton.Text = "+"
        -- Buttons ausblenden
        flyButton.Visible = false
        bladeBallButton.Visible = false
        tpAuraButton.Visible = false
        wallhackButton.Visible = false
        closeButton.Visible = false
    end
end)

-- Funktionen für Buttons
flyButton.MouseButton1Click:Connect(function()
    toggleFly()
end)

bladeBallButton.MouseButton1Click:Connect(function()
    moveInCircle()  -- Starte die Bewegung im Kreis um den Ball
end)

tpAuraButton.MouseButton1Click:Connect(function()
    toggleTPAura()
end)

wallhackButton.MouseButton1Click:Connect(function()
    toggleWallhack()
end)

closeButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()  -- Menü schließen
end)
