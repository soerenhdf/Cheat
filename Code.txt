-- Key Check UI (Startmenü)
local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- Hauptmenü Frame (wird später sichtbar)
local menuFrame = Instance.new("Frame")
menuFrame.Size = UDim2.new(0, 300, 0, 400)
menuFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
menuFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
menuFrame.Active = true
menuFrame.Draggable = true
menuFrame.Visible = false
menuFrame.Parent = player:WaitForChild("PlayerGui")

-- Menü Tabs
local tabHeader = Instance.new("TextLabel", menuFrame)
tabHeader.Size = UDim2.new(1, 0, 0, 30)
tabHeader.Position = UDim2.new(0, 0, 0, 0)
tabHeader.Text = "By Crash Stars"
tabHeader.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
tabHeader.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Fly Button
local flyEnabled = false
local flyBtn = Instance.new("TextButton", menuFrame)
flyBtn.Size = UDim2.new(1, -20, 0, 40)
flyBtn.Position = UDim2.new(0, 10, 0, 40)
flyBtn.Text = "Fly"
flyBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
flyBtn.TextColor3 = Color3.fromRGB(255, 255, 255)

-- TP Aura
local tpAuraEnabled = false
local tpAuraBtn = Instance.new("TextButton", menuFrame)
tpAuraBtn.Size = UDim2.new(1, -20, 0, 40)
tpAuraBtn.Position = UDim2.new(0, 10, 0, 90)
tpAuraBtn.Text = "TP Aura"
tpAuraBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
tpAuraBtn.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Wallhack
local wallHackEnabled = false
local wallHackBtn = Instance.new("TextButton", menuFrame)
wallHackBtn.Size = UDim2.new(1, -20, 0, 40)
wallHackBtn.Position = UDim2.new(0, 10, 0, 140)
wallHackBtn.Text = "WallHack"
wallHackBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
wallHackBtn.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Blade Ball
local bladeBallEnabled = false
local bladeBtn = Instance.new("TextButton", menuFrame)
bladeBtn.Size = UDim2.new(1, -20, 0, 40)
bladeBtn.Position = UDim2.new(0, 10, 0, 190)
bladeBtn.Text = "Blade Ball"
bladeBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
bladeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Menü schließen
local closeBtn = Instance.new("TextButton", menuFrame)
closeBtn.Size = UDim2.new(0, 30, 0, 30)
closeBtn.Position = UDim2.new(1, -35, 0, 5)
closeBtn.Text = "X"
closeBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Fly Funktion
flyBtn.MouseButton1Click:Connect(function()
    flyEnabled = not flyEnabled
    local UIS = game:GetService("UserInputService")
    local Char = player.Character or player.CharacterAdded:Wait()
    local HRP = Char:WaitForChild("HumanoidRootPart")
    local BV = Instance.new("BodyVelocity", HRP)
    BV.MaxForce = Vector3.new(1e5, 1e5, 1e5)
    while flyEnabled and Char and Char:FindFirstChild("HumanoidRootPart") do
        local cam = workspace.CurrentCamera.CFrame
        local move = Vector3.new()
        if UIS:IsKeyDown(Enum.KeyCode.W) then move += cam.LookVector end
        if UIS:IsKeyDown(Enum.KeyCode.S) then move -= cam.LookVector end
        if UIS:IsKeyDown(Enum.KeyCode.A) then move -= cam.RightVector end
        if UIS:IsKeyDown(Enum.KeyCode.D) then move += cam.RightVector end
        BV.Velocity = move.Unit * 100
        task.wait()
    end
    BV:Destroy()
end)

-- TP Aura Funktion
tpAuraBtn.MouseButton1Click:Connect(function()
    tpAuraEnabled = not tpAuraEnabled
    while tpAuraEnabled do
        local closestPlayer, dist = nil, math.huge
        for _, v in pairs(Players:GetPlayers()) do
            if v ~= player and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
                local d = (v.Character.HumanoidRootPart.Position - player.Character.HumanoidRootPart.Position).Magnitude
                if d < dist then
                    dist = d
                    closestPlayer = v
                end
            end
        end
        if closestPlayer then
            local offset = Vector3.new(math.random(-10,10), 0, math.random(-10,10)) * 5
            player.Character.HumanoidRootPart.CFrame = CFrame.new(closestPlayer.Character.HumanoidRootPart.Position + offset)
        end
        wait(0.2)
    end
end)

-- Wallhack Funktion
wallHackBtn.MouseButton1Click:Connect(function()
    wallHackEnabled = not wallHackEnabled
    for _, v in pairs(Players:GetPlayers()) do
        if v ~= player and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
            local box = Instance.new("BoxHandleAdornment")
            box.Adornee = v.Character.HumanoidRootPart
            box.Size = Vector3.new(4,6,2)
            box.AlwaysOnTop = true
            box.ZIndex = 10
            box.Color3 = Color3.fromRGB(255, 0, 0)
            box.Transparency = 0.2
            box.Parent = v.Character
        end
    end
end)

-- Blade Ball Hack
bladeBtn.MouseButton1Click:Connect(function()
    bladeBallEnabled = not bladeBallEnabled
    while bladeBallEnabled do
        local ball = workspace:FindFirstChild("BladeBall")
        if ball and ball:IsA("BasePart") then
            local root = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
            if root then
                local angle = tick() * 4
                local offset = Vector3.new(math.cos(angle), 0, math.sin(angle)) * 125
                root.CFrame = CFrame.new(ball.Position + offset, ball.Position)
                if (ball.Position - root.Position).Magnitude < 15 then
                    firetouchinterest(root, ball, 0)
                    firetouchinterest(root, ball, 1)
                end
            end
        end
        wait(0.05)
    end
end)

-- Menü schließen
closeBtn.MouseButton1Click:Connect(function()
    menuFrame:Destroy()
end)

-- Eingabeaufforderung für den Key
local keyFrame = Instance.new("Frame", player:WaitForChild("PlayerGui"))
keyFrame.Size = UDim2.new(0, 300, 0, 150)
keyFrame.Position = UDim2.new(0.5, -150, 0.5, -75)
keyFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)

local keyBox = Instance.new("TextBox", keyFrame)
keyBox.Size = UDim2.new(0.8, 0, 0, 40)
keyBox.Position = UDim2.new(0.1, 0, 0.2, 0)
keyBox.PlaceholderText = "Enter Key"
keyBox.TextColor3 = Color3.fromRGB(255,255,255)
keyBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)

local submit = Instance.new("TextButton", keyFrame)
submit.Size = UDim2.new(0.8, 0, 0, 40)
submit.Position = UDim2.new(0.1, 0, 0.6, 0)
submit.Text = "Submit"
submit.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
submit.TextColor3 = Color3.fromRGB(255,255,255)

submit.MouseButton1Click:Connect(function()
    if keyBox.Text == "#crash-key" then
        keyFrame.Visible = false
        menuFrame.Visible = true
    else
        submit.Text = "Wrong Key"
    end
end)
