-- GUI erstellen
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
local Toggle = Instance.new("TextButton", ScreenGui)
Toggle.Size = UDim2.new(0, 150, 0, 50)
Toggle.Position = UDim2.new(0, 20, 0, 150)
Toggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
Toggle.TextColor3 = Color3.new(1, 1, 1)
Toggle.Text = "Start AI"
Toggle.TextScaled = true

local aiRunning = false
local player = game.Players.LocalPlayer
local pathfindingService = game:GetService("PathfindingService")
local targetPosition = nil

-- Wenn der Spieler auf einen Punkt klickt
game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        targetPosition = workspace.CurrentCamera:ScreenToWorldPoint(Vector3.new(input.Position.X, input.Position.Y, 0))
        if targetPosition then
            -- Starte den Wegplanungsprozess
            startAI(targetPosition)
        end
    end
end)

-- KI starten, um zum Ziel zu gehen
local function startAI(target)
    aiRunning = true
    local path = pathfindingService:CreatePath({
        AgentRadius = 2,
        AgentHeight = 5,
        AgentCanJump = true,
        AgentJumpHeight = 10,
        AgentMaxSlope = 45,
    })

    -- Berechne den Pfad zum Ziel
    path:ComputeAsync(player.Character.HumanoidRootPart.Position, target)

    -- Bewege den Charakter entlang des Pfades
    path:MoveTo(player.Character)

    -- Wenn der Pfad abgeschlossen ist, stoppe die KI
    path.Completed:Wait()
    aiRunning = false
end

-- Stoppen der KI
local function stopAI()
    aiRunning = false
end

-- Button für das Starten/Stoppen der KI
Toggle.MouseButton1Click:Connect(function()
    if aiRunning then
        stopAI()
        Toggle.Text = "Start AI"
    else
        startAI(targetPosition)
        Toggle.Text = "Stop AI"
    end
end)

-- Funktion um die KI kontinuierlich zu steuern
while true do
    if aiRunning and targetPosition then
        startAI(targetPosition)  -- Sicherstellen, dass der AI-Pfad kontinuierlich verfolgt wird
    end
    wait(0.5)  -- Verzögerung, um die CPU-Belastung zu minimieren
end
